<!DOCTYPE html>

<html>
<head>
  <meta charset="utf-8" />
  <title>text in-out template</title>
    <script src="superfetch2.js"></script>
    <script src="server.js"></script>
    <link href="style.css" rel="stylesheet">
    
</head>

<body>
    <div id="box1">
        <h1 id="velkommen">Logg inn</h1>
    <input type ="text"     id="username" placeholder="Login name" />
    <input type="password"  id="password" placeholder="Password"  />

    <button id="btnlogin">Logg inn</button>
    <br>
    <div id="txtOut">The result...</div>
    </div>
</body>

<script>

    // init ------------------------------------------
    var username  = document.getElementById("username");
    var password  = document.getElementById("password");
    
    var btnlogin = document.getElementById("btnlogin");
    var txtOut    = document.getElementById("txtOut");

    

    var respStatus;
    var imgfile = "";

    
    btnlogin.onclick = loginUser;       

    // ------------------------------------------------
    function loginUser() { 
        
        var upload = JSON.stringify({
            username:username.value, 
            password: password.value
        })
        
        var url = "http://localhost:3000/users/auth/";
        
        
        
        var cfg = {
            method: "POST",
            body: upload
        }
        superfetch(url, "json", succ, error, cfg);      
    }
    
    // succ ------------------------------------------------
    function succ(data) {  
        
        console.log(data);
        
        localStorage.setItem("logindata", JSON.stringify(data));
        
        // token blir opprettet 
         //token inni her: localStorage.setItem("logindata", JSON.stringify(data));
        //send til ny side
       
    }
    
    // error--------------------------------------------
        
    function error(err){
        console.log(err); 
    }
        
          
    
    
    
    /*
            localStorage.setItem("blogfogData", JSON.stringify(data));
            window.location.href = "showusers.html";
        }
        else {
            txtMsg.innerHTML = "Something went wrong. Please try again later";
        }
    }
    
    // ------------------------------------------------
    function error(error) {
               
        txtMsg.innerHTML = "Something went wrong. Please try again later";      
    }    
    
    
    
    
    */
    

    
    
    
    
    
    
    /*
    
    
    
    
    
    function createUser() {
        //retrieve data from e.g. a form and append it to a FormData object
        var fdata = new FormData();

        fdata.append("loginname", inplogin.value);
        fdata.append("password", inppassw.value);
        var fetchSettings = {
            method: "POST",
            body: fdata
        }

        var respstatus;

        fetch("http://46.250.220.73:8080/blogfog/users/auth/", fetchSettings)
        .then(function(resp) {
            //step 1
            respstatus = resp.ok;
            return resp.json();

        }).then(function(data) {
            //step 2
            if (respstatus) {
                //success
                txtOut.innerHTML = `
                                <h3>${data.fullname}</h3>
                                <img src="${data.image}" />
                                <p>${data.message}</p>
                                <button onClick="window.location='4brukerOversikt.html';" value="click here">Se brukere</button>
                                <p id="brukere"></p>`;

                //localStorage.setItem("token", data.token); //save token
                localStorage.setItem("blogfogData", JSON.stringify(data));
            }
            else {
                //something went wrong
                console.log(data);
                txtOut.innerHTML = data.msg;
            }

        }).catch(function(err) {

        });
    }



    // -----------------------------------------------
    function selectImage() {
    imgfile = inpfile.files[0];
    }





*/







</script>



</html>
